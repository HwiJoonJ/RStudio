---
title: "산업공학특론I 3주차_확률변수와 확률분포22"
author: "HwijoonJ (wjdgnlwns20@psm.hanyang.ac.kr)"
date: "`r format(Sys.Date())`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=12, fig.height=12)
```

<br>
<br>
<br>

## **[Study Summary]**

### 1. Central Limit Theorm
```{r simulation }
x = list()
for(i in 1:100) {
  x[[i]] = rnorm(10000, mean=20, sd=10)
}
meanx = Reduce('+', x)/length(x)

sprintf("E[X] = %f", mean(meanx))
sprintf("Var[X] = %f", sd(meanx)^2)
```

### 2. Mean, Var
```{r simulation_mv}
meanvar = function(dist, n=10000, param) {
  #parameter = lambda
  if(dist == 'expo') {
    rand = rexp(n, rate=param[1])
    M = 1/param[1]; V = 1/param[1]^2
  }
  #parameter = n , p
  else if(dist == 'binom') {
    rand = rbinom(n, size=param[1], prob=param[2])
    M = param[1]*param[2]; V = param[1]*param[2]*(1-param[2])
  }
  sprintf("Simulation: E[X] = %f, Var[X] = %f, Theorm: E[X] = %f, Var[X] = %f", mean(rand), var(rand), M, V)
}

meanvar('expo', n=1000, 0.1)
```

## **[Data Analysis]**

### 1. 대상 데이터 확보: 공구 마모 데이터셋
(https://www.kaggle.com/datasets/shivamb/machine-predictive-maintenance-classification)

생산 공정의 예지보전을 목적으로 실제 측정 데이터에 공정의 환경을 합성한 데이터

다중 공정 중 단일한 설비를 대상으로 데이터 수집/생성

10,000개의 데이터 포인트와 10개의 변수로 구성되며, 각 변수에 대한 설명은 다음과 같음

| Column Name | Explain |
|:--------- | :--------------------- |
| UID | 1부터 10,000까지의 범위를 가지는 고유 식별자 |
| ProductID | 제품 등급에 따라 낮음(L), 중간(M), 높음(H)으로 분류하였으며, 각각 전체의 50%, 30%, 20%를 차지 |
| Air temperature [K] | 표준 편차가 2K인 300K 주변으로 정규화된 랜덤 워크 과정을 사용하여 인위적으로 생성 |
| Process temperature [K] | 표준 편차가 1K인 랜덤 워크 과정을 사용하여 생성되고, 공기 온도에 10K를 더한 값에 정규화 |
| Rotational speed [rpm] | 2860W를 중심으로 계산 및 생성되었으며, 정규 분포를 따르는 잡음이 인가되어 있음 |
| Torque [Nm] | 40Nm 주변에서 정규분포를 따르며, 표준 편차는 10Nm이고, 음수 값은 없음 |
| Tool wear [min] | 공구의 마모 시간으로, Target 변수와 연동하여 고장 유무에 따른 시간을 검토할 수 있음 |
| Target | 고장 유무 |
| Failure type | 고장의 유형 |

<br>
<br>
<br>

### 2. 데이터 탐색 (EDA) 및 전처리
```{r data_eda}
#Load Data
library(DT)

#Set Working Directory
setwd("C:/Users/HwiJoon/OneDrive/문서/RStudio")
dat = read.csv("산업공학특론I_3주차_실습 데이터.csv")

#Drop columns
dat = dat[,-(1:2)]
datatable(head(dat, 30), class = 'cell-border stripe', caption='R-Drill Dataset')

#Target Data change into Categorical
dat$Target = as.factor(dat$Target)
dat$Type = as.factor(dat$Type)
dat$Failure.Type = as.factor(dat$Failure.Type)

#Summary Data
summary(dat)
```

<br>
<br>
<br>

### 3. 데이터 그룹화 및 기술통계량 검토
```{r data_group}
#Data Visualization and Compare
visualize = function(x) {
  if(is.factor(x)) {
    barplot(table(x), col='navy')
  }
  else {
    hist(x, col='navy')
  }
}

par(mfrow = c(4,2))
for (i in 1:ncol(dat)) {
  visualize(x = dat[,i])
}

#Split Data as Target Value
sdat = split(dat$Tool.wear..min., dat$Target)
disc = data.frame(rbind(summary(sdat[[1]]), summary(sdat[[2]])))
rownames(disc) = c('Censored', 'Failed')
print(disc)
```


<br>
<br>
<br>

### 4. 확률분포 적합

```{r data_dist}
#Load library
library(fitdistrplus)

#Censored Data and Failed Data
cens = sdat[[1]]
fail = sdat[[2]]

#Fitting Exp Distribtuion Each Data
fitdist(cens, 'exp')
fitdist(fail, 'exp')

#Fitting Norm Distribution Each Data
fitdist(cens, 'norm')
fitdist(fail, 'norm')
```
